{
    "annotations": {
        "list": [
            {
                "builtIn": 1,
                "datasource": { "type": "grafana", "uid": "-- Grafana --" },
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
            }
        ]
    },
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 0,
    "links": [],
    "panels": [
        {
            "collapsed": false,
            "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
            "id": 10,
            "panels": [],
            "repeat": "service_name",
            "title": "$service_name",
            "type": "row"
        },
        {
            "datasource": { "uid": "loki" },
            "fieldConfig": {
                "defaults": {
                    "color": { "fixedColor": "green", "mode": "fixed" },
                    "custom": {
                        "fillOpacity": 80,
                        "gradientMode": "none",
                        "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                        "lineWidth": 1,
                        "stacking": { "group": "A", "mode": "none" }
                    },
                    "fieldMinMax": false,
                    "mappings": [],
                    "min": 0,
                    "thresholds": { "mode": "absolute", "steps": [{ "color": "green" }] },
                    "unit": "ms"
                },
                "overrides": []
            },
            "gridPos": { "h": 6, "w": 24, "x": 0, "y": 1 },
            "id": 12,
            "options": {
                "combine": false,
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                },
                "tooltip": { "hideZeros": false, "mode": "multi", "sort": "none" }
            },
            "pluginVersion": "12.0.2",
            "targets": [
                {
                    "direction": "backward",
                    "editorMode": "builder",
                    "expr": "{service_namespace=\"NewHomie\", service_name=\"$service_name\"} | detected_level =~ `info` | faas_duration > 0",
                    "hide": false,
                    "queryType": "range",
                    "refId": "A"
                }
            ],
            "title": "faas_duration histogram",
            "transformations": [
                {
                    "id": "extractFields",
                    "options": {
                        "delimiter": ",",
                        "format": "kvp",
                        "jsonPaths": [{ "path": "object.args" }],
                        "keepTime": false,
                        "regExp": "/(args_page)/",
                        "replace": false,
                        "source": "labels"
                    }
                },
                {
                    "id": "filterFieldsByName",
                    "options": { "include": { "names": [], "pattern": "faas_duration" } }
                },
                {
                    "id": "convertFieldType",
                    "options": {
                        "conversions": [
                            { "destinationType": "number", "targetField": "faas_duration" }
                        ],
                        "fields": {}
                    }
                }
            ],
            "transparent": true,
            "type": "histogram"
        },
        {
            "datasource": { "uid": "loki" },
            "fieldConfig": {
                "defaults": {
                    "color": { "fixedColor": "green", "mode": "fixed" },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "fillOpacity": 100,
                        "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                        "pointShape": "circle",
                        "pointSize": { "fixed": 3 },
                        "pointStrokeWidth": 1,
                        "scaleDistribution": { "type": "linear" },
                        "show": "points"
                    },
                    "fieldMinMax": false,
                    "mappings": [],
                    "max": 900000,
                    "min": 0,
                    "thresholds": { "mode": "absolute", "steps": [{ "color": "green" }] },
                    "unit": "ms"
                },
                "overrides": []
            },
            "gridPos": { "h": 6, "w": 24, "x": 0, "y": 7 },
            "id": 13,
            "options": {
                "legend": {
                    "calcs": ["sum", "min", "p25", "median", "p99", "max"],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "mapping": "auto",
                "series": [
                    {
                        "frame": { "matcher": { "id": "byIndex", "options": 0 } },
                        "x": { "matcher": { "id": "byName", "options": "faas_time" } },
                        "y": { "matcher": { "id": "byName", "options": "faas_duration" } }
                    }
                ],
                "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }
            },
            "pluginVersion": "12.0.2",
            "targets": [
                {
                    "direction": "backward",
                    "editorMode": "builder",
                    "expr": "{service_namespace=\"NewHomie\", service_name=\"$service_name\"} | detected_level =~ `info` | faas_duration > 0",
                    "hide": false,
                    "queryType": "range",
                    "refId": "A"
                }
            ],
            "title": "faas_duration",
            "transformations": [
                {
                    "id": "extractFields",
                    "options": {
                        "delimiter": ",",
                        "format": "kvp",
                        "jsonPaths": [{ "path": "object.args" }],
                        "keepTime": false,
                        "regExp": "/(args_page)/",
                        "replace": false,
                        "source": "labels"
                    }
                },
                {
                    "id": "filterFieldsByName",
                    "options": { "include": { "pattern": "(faas_time|faas_duration)" } }
                },
                {
                    "id": "convertFieldType",
                    "options": {
                        "conversions": [
                            { "destinationType": "number", "targetField": "faas_duration" },
                            { "destinationType": "time", "targetField": "faas_time" }
                        ],
                        "fields": {}
                    }
                }
            ],
            "transparent": true,
            "type": "xychart"
        },
        {
            "datasource": { "uid": "loki" },
            "fieldConfig": {
                "defaults": {
                    "custom": {
                        "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                        "scaleDistribution": { "type": "linear" }
                    }
                },
                "overrides": []
            },
            "gridPos": { "h": 6, "w": 24, "x": 0, "y": 13 },
            "id": 5,
            "options": {
                "calculate": false,
                "calculation": {
                    "xBuckets": { "mode": "size", "value": "" },
                    "yBuckets": { "mode": "size", "scale": { "type": "linear" }, "value": "" }
                },
                "cellGap": 0,
                "color": {
                    "exponent": 2,
                    "fill": "orange",
                    "min": 0,
                    "mode": "scheme",
                    "reverse": true,
                    "scale": "linear",
                    "scheme": "YlOrRd",
                    "steps": 128
                },
                "exemplars": { "color": "rgba(255,0,255,0.7)" },
                "filterValues": { "le": 1e-9 },
                "legend": { "show": true },
                "rowsFrame": { "layout": "unknown" },
                "tooltip": { "mode": "multi", "showColorScale": false, "yHistogram": false },
                "yAxis": { "axisPlacement": "hidden", "reverse": false }
            },
            "pluginVersion": "12.0.2",
            "targets": [
                {
                    "direction": "backward",
                    "editorMode": "builder",
                    "expr": "count by(detected_level) (count_over_time({service_namespace=\"NewHomie\", service_name=\"$service_name\"} | code_function_name != `` | detected_level =~ `(fatal|error|warn)` [$__auto]))",
                    "hide": true,
                    "legendFormat": "",
                    "queryType": "range",
                    "refId": "Source",
                    "step": "1m"
                },
                {
                    "datasource": { "name": "Expression", "type": "__expr__", "uid": "__expr__" },
                    "downsampler": "sum",
                    "expression": "Source",
                    "hide": false,
                    "refId": "detected_level",
                    "type": "resample",
                    "upsampler": "fillna",
                    "window": "$heatmap_interval"
                }
            ],
            "title": "detected_level heatmap",
            "transformations": [
                { "id": "joinByField", "options": { "byField": "Time", "mode": "outer" } },
                {
                    "filter": { "id": "byRefId", "options": "" },
                    "id": "organize",
                    "options": {
                        "excludeByName": {
                            "Time": false,
                            "{detected_level=\"error\"}": true,
                            "{detected_level=\"fatal\"}": true,
                            "{detected_level=\"warn\"}": true
                        },
                        "includeByName": {},
                        "indexByName": {
                            "Time": 0,
                            "detected_level error": 2,
                            "detected_level fatal": 3,
                            "detected_level warn": 1
                        },
                        "renameByName": {
                            "Data error": "",
                            "Data fatal": "",
                            "Data warn": "",
                            "ERROR": "",
                            "TRACE": "",
                            "Time": "",
                            "{detected_level=\"debug\"}": "DEBUG",
                            "{detected_level=\"error\"}": "ERROR",
                            "{detected_level=\"fatal\"}": "FATAL",
                            "{detected_level=\"info\"}": "INFO",
                            "{detected_level=\"trace\"}": "TRACE",
                            "{detected_level=\"warn\"}": "WARN"
                        }
                    }
                }
            ],
            "transparent": true,
            "type": "heatmap"
        },
        {
            "datasource": { "uid": "loki" },
            "fieldConfig": {
                "defaults": {
                    "custom": {
                        "hideFrom": { "legend": false, "tooltip": false, "viz": false },
                        "scaleDistribution": { "type": "linear" }
                    }
                },
                "overrides": []
            },
            "gridPos": { "h": 6, "w": 24, "x": 0, "y": 19 },
            "id": 9,
            "options": {
                "calculate": false,
                "calculation": {
                    "xBuckets": { "mode": "size", "value": "" },
                    "yBuckets": { "mode": "size", "scale": { "type": "linear" }, "value": "" }
                },
                "cellGap": 0,
                "color": {
                    "exponent": 2,
                    "fill": "orange",
                    "min": 0,
                    "mode": "scheme",
                    "reverse": true,
                    "scale": "linear",
                    "scheme": "YlOrRd",
                    "steps": 128
                },
                "exemplars": { "color": "rgba(255,0,255,0.7)" },
                "filterValues": { "le": 1e-9 },
                "legend": { "show": true },
                "rowsFrame": { "layout": "unknown" },
                "tooltip": { "mode": "multi", "showColorScale": false, "yHistogram": false },
                "yAxis": { "axisPlacement": "hidden", "reverse": false }
            },
            "pluginVersion": "12.0.2",
            "targets": [
                {
                    "direction": "backward",
                    "editorMode": "builder",
                    "expr": "count by(code_function_name) (count_over_time({service_namespace=\"NewHomie\", service_name=\"$service_name\"} | code_function_name != `` | detected_level =~ `(fatal|error|warn)` [$__auto]))",
                    "hide": true,
                    "legendFormat": "",
                    "queryType": "range",
                    "refId": "Source",
                    "step": "1m"
                },
                {
                    "datasource": { "name": "Expression", "type": "__expr__", "uid": "__expr__" },
                    "downsampler": "sum",
                    "expression": "Source",
                    "hide": false,
                    "refId": "code_function_name",
                    "type": "resample",
                    "upsampler": "fillna",
                    "window": "$heatmap_interval"
                }
            ],
            "title": "code_function_name heatmap",
            "transformations": [
                { "id": "joinByField", "options": { "byField": "Time", "mode": "outer" } },
                {
                    "id": "organize",
                    "options": {
                        "excludeByName": {
                            "Time": false,
                            "{code_function_name=\"BrowserService.Error\"}": true,
                            "{code_function_name=\"BrowserService.getHTML\"}": true,
                            "{code_function_name=\"DomainListingsService.tryExtractListings\"}": true,
                            "{code_function_name=\"DomainListingsService.tryTransformSalePrice\"}": true,
                            "{code_function_name=\"DomainSuburbService.tryExtractProfile\"}": true,
                            "{detected_level=\"error\"}": true,
                            "{detected_level=\"fatal\"}": true,
                            "{detected_level=\"warn\"}": true
                        },
                        "includeByName": {},
                        "indexByName": {
                            "Data error": 2,
                            "Data fatal": 3,
                            "Data warn": 1,
                            "Time": 0,
                            "{detected_level=\"error\"}": 5,
                            "{detected_level=\"fatal\"}": 6,
                            "{detected_level=\"warn\"}": 4
                        },
                        "renameByName": {
                            "Data error": "ERROR",
                            "Data fatal": "FATAL",
                            "Data warn": "WARN",
                            "ERROR": "",
                            "TRACE": "",
                            "Time": "",
                            "{detected_level=\"debug\"}": "DEBUG",
                            "{detected_level=\"error\"}": "ERROR",
                            "{detected_level=\"fatal\"}": "FATAL",
                            "{detected_level=\"info\"}": "INFO",
                            "{detected_level=\"trace\"}": "TRACE",
                            "{detected_level=\"warn\"}": "WARN"
                        }
                    }
                }
            ],
            "transparent": true,
            "type": "heatmap"
        },
        {
            "datasource": { "uid": "loki" },
            "fieldConfig": {
                "defaults": {
                    "custom": {
                        "align": "auto",
                        "cellOptions": { "type": "auto", "wrapText": false },
                        "filterable": true,
                        "inspect": true
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [{ "color": "green" }, { "color": "red", "value": 80 }]
                    }
                },
                "overrides": [
                    {
                        "matcher": { "id": "byName", "options": "Line" },
                        "properties": [{ "id": "custom.width", "value": 426 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "trace_id" },
                        "properties": [{ "id": "custom.width", "value": 94 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "labels" },
                        "properties": [{ "id": "custom.width", "value": 144 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "code_function_name" },
                        "properties": [{ "id": "custom.width", "value": 357 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "code_function_args" },
                        "properties": [{ "id": "custom.width", "value": 21 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "exception_type" },
                        "properties": [{ "id": "custom.width", "value": 152 }]
                    },
                    {
                        "matcher": { "id": "byName", "options": "exception_stacktrace" },
                        "properties": [{ "id": "custom.width", "value": 45 }]
                    }
                ]
            },
            "gridPos": { "h": 9, "w": 24, "x": 0, "y": 25 },
            "id": 15,
            "options": {
                "cellHeight": "sm",
                "footer": {
                    "countRows": false,
                    "enablePagination": true,
                    "fields": "",
                    "reducer": ["sum"],
                    "show": false
                },
                "showHeader": true,
                "sortBy": []
            },
            "pluginVersion": "12.0.2",
            "targets": [
                {
                    "direction": "backward",
                    "editorMode": "builder",
                    "expr": "{service_namespace=\"NewHomie\", service_name=\"$service_name\"} | detected_level =~ `${log_level}`",
                    "queryType": "range",
                    "refId": "A"
                }
            ],
            "title": "detected_level exception logs",
            "transformations": [
                { "id": "filterFieldsByName", "options": { "include": { "pattern": "(labels)" } } },
                {
                    "id": "extractFields",
                    "options": {
                        "delimiter": ",",
                        "format": "kvp",
                        "jsonPaths": [{ "path": "object.args" }],
                        "keepTime": false,
                        "regExp": "/(args_page)/",
                        "replace": false,
                        "source": "labels"
                    }
                },
                {
                    "id": "filterFieldsByName",
                    "options": {
                        "include": {
                            "pattern": "(code_function_name|code_function_args|exception_type|exception_stacktrace|exception_message)"
                        }
                    }
                },
                {
                    "id": "organize",
                    "options": {
                        "excludeByName": {
                            "Time": true,
                            "detected_level": true,
                            "exception_stacktrace": false,
                            "exception_type": false,
                            "host_arch": true,
                            "host_id": true,
                            "host_name": true,
                            "labels": false,
                            "observed_timestamp": true,
                            "os_type": true,
                            "os_version": true,
                            "process_command": true,
                            "process_command_args": true,
                            "process_executable_name": true,
                            "process_executable_path": true,
                            "process_owner": true,
                            "process_pid": true,
                            "process_runtime_description": true,
                            "process_runtime_name": true,
                            "process_runtime_version": true,
                            "scope_name": true,
                            "scope_version": true,
                            "service_name": true,
                            "service_namespace": true,
                            "service_version": true,
                            "severity_number": true,
                            "severity_text": true
                        },
                        "includeByName": {},
                        "indexByName": {
                            "code_function_args": 1,
                            "code_function_name": 0,
                            "exception_message": 4,
                            "exception_stacktrace": 3,
                            "exception_type": 2
                        },
                        "renameByName": {}
                    }
                }
            ],
            "transparent": true,
            "type": "table"
        }
    ],
    "preload": false,
    "schemaVersion": 41,
    "tags": [],
    "templating": {
        "list": [
            {
                "auto": true,
                "auto_count": 100,
                "auto_min": "1s",
                "current": { "text": "1s", "value": "1s" },
                "description": "",
                "name": "heatmap_interval",
                "options": [
                    { "selected": true, "text": "1s", "value": "1s" },
                    { "selected": false, "text": "2s", "value": "2s" },
                    { "selected": false, "text": "5s", "value": "5s" },
                    { "selected": false, "text": "10s", "value": "10s" },
                    { "selected": false, "text": "20s", "value": "20s" },
                    { "selected": false, "text": "30s", "value": "30s" },
                    { "selected": false, "text": "1m", "value": "1m" },
                    { "selected": false, "text": "2m", "value": "2m" },
                    { "selected": false, "text": "5m", "value": "5m" },
                    { "selected": false, "text": "10m", "value": "10m" },
                    { "selected": false, "text": "15m", "value": "15m" },
                    { "selected": false, "text": "20m", "value": "20m" }
                ],
                "query": "1s,2s,5s,10s,20s,30s,1m,2m,5m,10m,15m,20m",
                "refresh": 2,
                "type": "interval"
            },
            {
                "allowCustomValue": false,
                "current": { "text": "$__all", "value": "$__all" },
                "description": "",
                "includeAll": true,
                "multi": true,
                "name": "log_level",
                "options": [
                    { "selected": false, "text": "fatal", "value": "fatal" },
                    { "selected": false, "text": "error", "value": "error" },
                    { "selected": false, "text": "warn", "value": "warn" },
                    { "selected": false, "text": "info", "value": "info" },
                    { "selected": false, "text": "debug", "value": "debug" },
                    { "selected": false, "text": "trace", "value": "trace" }
                ],
                "query": "fatal,error,warn,info,debug,trace",
                "type": "custom"
            },
            {
                "allowCustomValue": false,
                "current": { "text": ["$__all"], "value": ["$__all"] },
                "description": "",
                "includeAll": true,
                "label": "service_name",
                "multi": true,
                "name": "service_name",
                "options": [
                    {
                        "selected": false,
                        "text": "function-scrape_locality_trigger",
                        "value": "function-scrape_locality_trigger"
                    },
                    {
                        "selected": false,
                        "text": "function-scrape_locality",
                        "value": "function-scrape_locality"
                    }
                ],
                "query": "function-scrape_locality_trigger,function-scrape_locality",
                "type": "custom"
            }
        ]
    },
    "time": { "from": "now-6h", "to": "now" },
    "timepicker": {},
    "timezone": "browser",
    "title": "stack-service_scrape_pipeline",
    "uid": "c7106517-a852-446a-aa7b-800c8a522bc0",
    "version": 61
}
