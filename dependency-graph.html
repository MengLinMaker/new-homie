<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>dependency graph</title>
    <style>
      .node:active path,
.node:hover path,
.node.current path,
.node:active polygon,
.node:hover polygon,
.node.current polygon {
  stroke: fuchsia;
  stroke-width: 2;
}

.edge:active path,
.edge:hover path,
.edge.current path,
.edge:active ellipse,
.edge:hover ellipse,
.edge.current ellipse {
  stroke: url(#edgeGradient);
  stroke-width: 3;
  stroke-opacity: 1;
}

.edge:active polygon,
.edge:hover polygon,
.edge.current polygon {
  stroke: fuchsia;
  stroke-width: 3;
  fill: fuchsia;
  stroke-opacity: 1;
  fill-opacity: 1;
}

.edge:active text,
.edge:hover text {
  fill: fuchsia;
}

.cluster path {
  stroke-width: 3;
}

.cluster:active path,
.cluster:hover path {
  fill: #ffff0011;
}

div.hint {
  background-color: #000000aa;
  color: white;
  font-family: Arial, Helvetica, sans-serif;
  border-radius: 1rem;
  position: fixed;
  top: calc(50% - 4em);
  right: calc(50% - 10em);
  border: none;
  padding: 1em 3em 1em 1em;
}

.hint button {
  position: absolute;
  font-weight: bolder;
  right: 0.6em;
  top: 0.6em;
  color: inherit;
  background-color: inherit;
  border: 1px solid currentColor;
  border-radius: 1em;
  margin-left: 0.6em;
}

.hint a {
  color: inherit;
}

#button_help {
  color: white;
  background-color: #00000011;
  border-radius: 1em;
  position: fixed;
  top: 1em;
  right: 1em;
  font-size: 24pt;
  font-weight: bolder;
  width: 2em;
  height: 2em;
  border: none;
}

#button_help:hover {
  cursor: pointer;
  background-color: #00000077;
}

@media print {
  #button_help {
    display: none;
  }

  div.hint {
    display: none;
  }
}

    </style>
  </head>
  <body>
    <button id="button_help">?</button>
    <div id="hints" class="hint" style="display: none">
      <button id="close-hints">x</button>
      <span id="hint-text"></span>
      <ul>
        <li><b>Hover</b> - highlight</li>
        <li><b>Right-click</b> - pin highlight</li>
        <li><b>ESC</b> - clear</li>
      </ul>
    </div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.0.0 (20250608.1624)
 -->
<!-- Title: dependency&#45;cruiser output Pages: 1 -->
<svg width="490pt" height="595pt"
 viewBox="0.00 0.00 490.00 595.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 591.31)">
<title>dependency&#45;cruiser output</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-591.31 486.12,-591.31 486.12,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_@service&#45;scrape</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M168.38,-25.31C168.38,-25.31 267.12,-25.31 267.12,-25.31 273.12,-25.31 279.12,-31.31 279.12,-37.31 279.12,-37.31 279.12,-65.31 279.12,-65.31 279.12,-71.31 273.12,-77.31 267.12,-77.31 267.12,-77.31 168.38,-77.31 168.38,-77.31 162.38,-77.31 156.38,-71.31 156.38,-65.31 156.38,-65.31 156.38,-37.31 156.38,-37.31 156.38,-31.31 162.38,-25.31 168.38,-25.31"/>
<text xml:space="preserve" text-anchor="middle" x="217.75" y="-64.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">@service&#45;scrape</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_apps</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M20,-85.31C20,-85.31 462.12,-85.31 462.12,-85.31 468.12,-85.31 474.12,-91.31 474.12,-97.31 474.12,-97.31 474.12,-567.31 474.12,-567.31 474.12,-573.31 468.12,-579.31 462.12,-579.31 462.12,-579.31 20,-579.31 20,-579.31 14,-579.31 8,-573.31 8,-567.31 8,-567.31 8,-97.31 8,-97.31 8,-91.31 14,-85.31 20,-85.31"/>
<text xml:space="preserve" text-anchor="middle" x="241.06" y="-566.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">apps</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_apps/service&#45;scrape</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M28,-93.31C28,-93.31 454.12,-93.31 454.12,-93.31 460.12,-93.31 466.12,-99.31 466.12,-105.31 466.12,-105.31 466.12,-541.31 466.12,-541.31 466.12,-547.31 460.12,-553.31 454.12,-553.31 454.12,-553.31 28,-553.31 28,-553.31 22,-553.31 16,-547.31 16,-541.31 16,-541.31 16,-105.31 16,-105.31 16,-99.31 22,-93.31 28,-93.31"/>
<text xml:space="preserve" text-anchor="middle" x="241.06" y="-540.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">service&#45;scrape</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_apps/service&#45;scrape/function&#45;batch_scrape_suburbs</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M36,-161.31C36,-161.31 446.12,-161.31 446.12,-161.31 452.12,-161.31 458.12,-167.31 458.12,-173.31 458.12,-173.31 458.12,-351.31 458.12,-351.31 458.12,-357.31 452.12,-363.31 446.12,-363.31 446.12,-363.31 36,-363.31 36,-363.31 30,-363.31 24,-357.31 24,-351.31 24,-351.31 24,-173.31 24,-173.31 24,-167.31 30,-161.31 36,-161.31"/>
<text xml:space="preserve" text-anchor="middle" x="241.06" y="-350.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">function&#45;batch_scrape_suburbs</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M44,-169.31C44,-169.31 438.12,-169.31 438.12,-169.31 444.12,-169.31 450.12,-175.31 450.12,-181.31 450.12,-181.31 450.12,-299.31 450.12,-299.31 450.12,-305.31 444.12,-311.31 438.12,-311.31 438.12,-311.31 44,-311.31 44,-311.31 38,-311.31 32,-305.31 32,-299.31 32,-299.31 32,-181.31 32,-181.31 32,-175.31 38,-169.31 44,-169.31"/>
<text xml:space="preserve" text-anchor="middle" x="241.06" y="-298.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">src</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M52,-177.31C52,-177.31 246.88,-177.31 246.88,-177.31 252.88,-177.31 258.88,-183.31 258.88,-189.31 258.88,-189.31 258.88,-247.31 258.88,-247.31 258.88,-253.31 252.88,-259.31 246.88,-259.31 246.88,-259.31 52,-259.31 52,-259.31 46,-259.31 40,-253.31 40,-247.31 40,-247.31 40,-189.31 40,-189.31 40,-183.31 46,-177.31 52,-177.31"/>
<text xml:space="preserve" text-anchor="middle" x="149.44" y="-246.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">scrape</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_apps/service&#45;scrape/lib&#45;db_service_scrape</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M60.62,-371.31C60.62,-371.31 446.12,-371.31 446.12,-371.31 452.12,-371.31 458.12,-377.31 458.12,-383.31 458.12,-383.31 458.12,-515.31 458.12,-515.31 458.12,-521.31 452.12,-527.31 446.12,-527.31 446.12,-527.31 60.62,-527.31 60.62,-527.31 54.62,-527.31 48.62,-521.31 48.62,-515.31 48.62,-515.31 48.62,-383.31 48.62,-383.31 48.62,-377.31 54.62,-371.31 60.62,-371.31"/>
<text xml:space="preserve" text-anchor="middle" x="253.38" y="-514.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">lib&#45;db_service_scrape</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_apps/service&#45;scrape/lib&#45;db_service_scrape/src</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M68.62,-379.31C68.62,-379.31 438.12,-379.31 438.12,-379.31 444.12,-379.31 450.12,-385.31 450.12,-391.31 450.12,-391.31 450.12,-463.31 450.12,-463.31 450.12,-469.31 444.12,-475.31 438.12,-475.31 438.12,-475.31 68.63,-475.31 68.63,-475.31 62.63,-475.31 56.62,-469.31 56.62,-463.31 56.62,-463.31 56.62,-391.31 56.62,-391.31 56.62,-385.31 62.62,-379.31 68.62,-379.31"/>
<text xml:space="preserve" text-anchor="middle" x="253.38" y="-462.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">src</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_apps/service&#45;scrape/script</title>
<path fill="#ffffff" stroke="lightgrey" stroke-width="2" d="M63.25,-101.31C63.25,-101.31 240.75,-101.31 240.75,-101.31 246.75,-101.31 252.75,-107.31 252.75,-113.31 252.75,-113.31 252.75,-141.31 252.75,-141.31 252.75,-147.31 246.75,-153.31 240.75,-153.31 240.75,-153.31 63.25,-153.31 63.25,-153.31 57.25,-153.31 51.25,-147.31 51.25,-141.31 51.25,-141.31 51.25,-113.31 51.25,-113.31 51.25,-107.31 57.25,-101.31 63.25,-101.31"/>
<text xml:space="preserve" text-anchor="middle" x="152" y="-140.76" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="9.00">script</text>
</g>
<!-- .dependency&#45;cruiser.cjs -->
<g id="node1" class="node">
<title>.dependency&#45;cruiser.cjs</title>
<g id="a_node1"><a xlink:href=".dependency-cruiser.cjs" xlink:title=".dependency&#45;cruiser.cjs">
<path fill="#ccffcc" stroke="black" d="M142.46,-77.19C142.46,-77.19 40.79,-77.19 40.79,-77.19 37.83,-77.19 34.88,-74.23 34.88,-71.27 34.88,-71.27 34.88,-65.35 34.88,-65.35 34.88,-62.4 37.83,-59.44 40.79,-59.44 40.79,-59.44 142.46,-59.44 142.46,-59.44 145.42,-59.44 148.38,-62.4 148.38,-65.35 148.38,-65.35 148.38,-71.27 148.38,-71.27 148.38,-74.23 145.42,-77.19 142.46,-77.19"/>
<text xml:space="preserve" text-anchor="start" x="42.88" y="-64.64" font-family="Helvetica,sans-Serif" font-size="9.00">.dependency&#45;cruiser.cjs</text>
</a>
</g>
</g>
<!-- @service&#45;scrape/lib&#45;db_service_scrape -->
<g id="node2" class="node">
<title>@service&#45;scrape/lib&#45;db_service_scrape</title>
<g id="a_node2"><a xlink:title="lib&#45;db_service_scrape">
<path fill="#ffffcc" stroke="black" d="M265.21,-51.19C265.21,-51.19 170.29,-51.19 170.29,-51.19 167.33,-51.19 164.38,-48.23 164.38,-45.27 164.38,-45.27 164.38,-39.35 164.38,-39.35 164.38,-36.4 167.33,-33.44 170.29,-33.44 170.29,-33.44 265.21,-33.44 265.21,-33.44 268.17,-33.44 271.12,-36.4 271.12,-39.35 271.12,-39.35 271.12,-45.27 271.12,-45.27 271.12,-48.23 268.17,-51.19 265.21,-51.19"/>
<text xml:space="preserve" text-anchor="start" x="172.38" y="-38.64" font-family="Helvetica,sans-Serif" font-size="9.00">lib&#45;db_service_scrape</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/env.ts -->
<g id="node3" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/env.ts</title>
<g id="a_node3"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/env.ts" xlink:title="env.ts">
<path fill="#ddfeff" stroke="black" d="M436.21,-242.19C436.21,-242.19 394.04,-242.19 394.04,-242.19 391.08,-242.19 388.12,-239.23 388.12,-236.27 388.12,-236.27 388.12,-230.35 388.12,-230.35 388.12,-227.4 391.08,-224.44 394.04,-224.44 394.04,-224.44 436.21,-224.44 436.21,-224.44 439.17,-224.44 442.12,-227.4 442.12,-230.35 442.12,-230.35 442.12,-236.27 442.12,-236.27 442.12,-239.23 439.17,-242.19 436.21,-242.19"/>
<text xml:space="preserve" text-anchor="start" x="403.12" y="-229.64" font-family="Helvetica,sans-Serif" font-size="9.00">env.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/index.mts -->
<g id="node4" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/index.mts</title>
<g id="a_node4"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/index.mts" xlink:title="index.mts">
<path fill="#ddfeff" stroke="black" d="M239.33,-285.19C239.33,-285.19 196.17,-285.19 196.17,-285.19 193.21,-285.19 190.25,-282.23 190.25,-279.27 190.25,-279.27 190.25,-273.35 190.25,-273.35 190.25,-270.4 193.21,-267.44 196.17,-267.44 196.17,-267.44 239.33,-267.44 239.33,-267.44 242.29,-267.44 245.25,-270.4 245.25,-273.35 245.25,-273.35 245.25,-279.27 245.25,-279.27 245.25,-282.23 242.29,-285.19 239.33,-285.19"/>
<text xml:space="preserve" text-anchor="start" x="198.25" y="-272.64" font-family="Helvetica,sans-Serif" font-size="9.00">index.mts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts -->
<g id="node5" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts</title>
<g id="a_node5"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/instrumentation.ts" xlink:title="instrumentation.ts">
<path fill="#ddfeff" stroke="black" d="M369.21,-242.19C369.21,-242.19 293.04,-242.19 293.04,-242.19 290.08,-242.19 287.12,-239.23 287.12,-236.27 287.12,-236.27 287.12,-230.35 287.12,-230.35 287.12,-227.4 290.08,-224.44 293.04,-224.44 293.04,-224.44 369.21,-224.44 369.21,-224.44 372.17,-224.44 375.12,-227.4 375.12,-230.35 375.12,-230.35 375.12,-236.27 375.12,-236.27 375.12,-239.23 372.17,-242.19 369.21,-242.19"/>
<text xml:space="preserve" text-anchor="start" x="295.12" y="-229.64" font-family="Helvetica,sans-Serif" font-size="9.00">instrumentation.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/index.mts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts -->
<g id="edge1" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/index.mts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M245.7,-271.8C256.32,-269.58 268.5,-266.46 279.12,-262.31 290.02,-258.06 301.4,-251.78 310.65,-246.16"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="311.63,-248.02 315.61,-243.06 309.41,-244.45 311.63,-248.02"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/env.ts -->
<g id="edge2" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/env.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M375.53,-233.31C377.34,-233.31 379.15,-233.31 380.94,-233.31"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="380.8,-235.41 386.8,-233.31 380.8,-231.21 380.8,-235.41"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts -->
<g id="node6" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts</title>
<g id="a_node6"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/scrape/domainListings.ts" xlink:title="domainListings.ts">
<path fill="#ddfeff" stroke="black" d="M129.33,-233.19C129.33,-233.19 53.92,-233.19 53.92,-233.19 50.96,-233.19 48,-230.23 48,-227.27 48,-227.27 48,-221.35 48,-221.35 48,-218.4 50.96,-215.44 53.92,-215.44 53.92,-215.44 129.33,-215.44 129.33,-215.44 132.29,-215.44 135.25,-218.4 135.25,-221.35 135.25,-221.35 135.25,-227.27 135.25,-227.27 135.25,-230.23 132.29,-233.19 129.33,-233.19"/>
<text xml:space="preserve" text-anchor="start" x="56" y="-220.64" font-family="Helvetica,sans-Serif" font-size="9.00">domainListings.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;@service&#45;scrape/lib&#45;db_service_scrape -->
<g id="edge5" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;@service&#45;scrape/lib&#45;db_service_scrape</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M135.54,-218.83C140.46,-216.57 144.93,-213.49 148.38,-209.31 164.12,-190.24 145.67,-120.61 156.38,-98.31 165.06,-80.22 182.37,-65.13 196.24,-55.19"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="197.07,-57.17 200.8,-52.03 194.68,-53.72 197.07,-57.17"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts -->
<g id="edge3" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M132.22,-233.67C140.18,-235.19 148.51,-236.52 156.38,-237.31 210.65,-242.79 224.61,-239.45 279.12,-237.31 279.44,-237.3 279.75,-237.29 280.06,-237.28"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="279.94,-239.38 285.83,-236.99 279.73,-235.19 279.94,-239.38"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts -->
<g id="node7" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts</title>
<g id="a_node7"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/scrape/scrapeUtil.ts" xlink:title="scrapeUtil.ts">
<path fill="#ddfeff" stroke="black" d="M244.96,-231.19C244.96,-231.19 190.54,-231.19 190.54,-231.19 187.58,-231.19 184.62,-228.23 184.62,-225.27 184.62,-225.27 184.62,-219.35 184.62,-219.35 184.62,-216.4 187.58,-213.44 190.54,-213.44 190.54,-213.44 244.96,-213.44 244.96,-213.44 247.92,-213.44 250.88,-216.4 250.88,-219.35 250.88,-219.35 250.88,-225.27 250.88,-225.27 250.88,-228.23 247.92,-231.19 244.96,-231.19"/>
<text xml:space="preserve" text-anchor="start" x="192.62" y="-218.64" font-family="Helvetica,sans-Serif" font-size="9.00">scrapeUtil.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts -->
<g id="edge4" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainListings.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M135.69,-223.62C149.28,-223.4 164.23,-223.16 177.54,-222.94"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="177.46,-225.05 183.42,-222.85 177.39,-220.85 177.46,-225.05"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts -->
<g id="edge8" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/scrapeUtil.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M251.26,-225.52C260.34,-226.42 270.42,-227.42 280.25,-228.39"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="279.92,-230.46 286.1,-228.96 280.34,-226.28 279.92,-230.46"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts -->
<g id="node8" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts</title>
<g id="a_node8"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/src/scrape/domainSuburb.ts" xlink:title="domainSuburb.ts">
<path fill="#ddfeff" stroke="black" d="M128.58,-203.19C128.58,-203.19 54.67,-203.19 54.67,-203.19 51.71,-203.19 48.75,-200.23 48.75,-197.27 48.75,-197.27 48.75,-191.35 48.75,-191.35 48.75,-188.4 51.71,-185.44 54.67,-185.44 54.67,-185.44 128.58,-185.44 128.58,-185.44 131.54,-185.44 134.5,-188.4 134.5,-191.35 134.5,-191.35 134.5,-197.27 134.5,-197.27 134.5,-200.23 131.54,-203.19 128.58,-203.19"/>
<text xml:space="preserve" text-anchor="start" x="56.75" y="-190.64" font-family="Helvetica,sans-Serif" font-size="9.00">domainSuburb.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts&#45;&gt;@service&#45;scrape/lib&#45;db_service_scrape -->
<g id="edge7" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts&#45;&gt;@service&#45;scrape/lib&#45;db_service_scrape</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M114.3,-185.02C126.32,-178.71 140.42,-169.16 148.38,-156.31 162.08,-134.19 144.36,-121.39 156.38,-98.31 165.56,-80.67 182.59,-65.66 196.23,-55.64"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="197.42,-57.37 201.1,-52.18 194.99,-53.95 197.42,-57.37"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts -->
<g id="edge6" class="edge">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/scrape/domainSuburb.ts&#45;&gt;apps/service&#45;scrape/function&#45;batch_scrape_suburbs/src/instrumentation.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M134.91,-192.5C173.25,-191.96 230.96,-193.96 279.12,-207.31 289.86,-210.29 300.98,-215.65 310.08,-220.73"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="309,-222.53 315.24,-223.71 311.1,-218.89 309,-222.53"/>
</g>
<!-- apps/service&#45;scrape/function&#45;batch_scrape_suburbs/vite.config.ts -->
<g id="node9" class="node">
<title>apps/service&#45;scrape/function&#45;batch_scrape_suburbs/vite.config.ts</title>
<g id="a_node9"><a xlink:href="apps/service-scrape/function-batch_scrape_suburbs/vite.config.ts" xlink:title="vite.config.ts">
<path fill="#ccffcc" stroke="black" d="M118.83,-337.19C118.83,-337.19 64.42,-337.19 64.42,-337.19 61.46,-337.19 58.5,-334.23 58.5,-331.27 58.5,-331.27 58.5,-325.35 58.5,-325.35 58.5,-322.4 61.46,-319.44 64.42,-319.44 64.42,-319.44 118.83,-319.44 118.83,-319.44 121.79,-319.44 124.75,-322.4 124.75,-325.35 124.75,-325.35 124.75,-331.27 124.75,-331.27 124.75,-334.23 121.79,-337.19 118.83,-337.19"/>
<text xml:space="preserve" text-anchor="start" x="66.5" y="-324.64" font-family="Helvetica,sans-Serif" font-size="9.00">vite.config.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/drizzle.config.ts -->
<g id="node10" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/drizzle.config.ts</title>
<g id="a_node10"><a xlink:href="apps/service-scrape/lib-db_service_scrape/drizzle.config.ts" xlink:title="drizzle.config.ts">
<path fill="#ddfeff" stroke="black" d="M251.33,-501.19C251.33,-501.19 184.17,-501.19 184.17,-501.19 181.21,-501.19 178.25,-498.23 178.25,-495.27 178.25,-495.27 178.25,-489.35 178.25,-489.35 178.25,-486.4 181.21,-483.44 184.17,-483.44 184.17,-483.44 251.33,-483.44 251.33,-483.44 254.29,-483.44 257.25,-486.4 257.25,-489.35 257.25,-489.35 257.25,-495.27 257.25,-495.27 257.25,-498.23 254.29,-501.19 251.33,-501.19"/>
<text xml:space="preserve" text-anchor="start" x="186.25" y="-488.64" font-family="Helvetica,sans-Serif" font-size="9.00">drizzle.config.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts -->
<g id="node11" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts</title>
<g id="a_node11"><a xlink:href="apps/service-scrape/lib-db_service_scrape/src/env.ts" xlink:title="env.ts">
<path fill="#ddfeff" stroke="black" d="M352.21,-449.19C352.21,-449.19 310.04,-449.19 310.04,-449.19 307.08,-449.19 304.12,-446.23 304.12,-443.27 304.12,-443.27 304.12,-437.35 304.12,-437.35 304.12,-434.4 307.08,-431.44 310.04,-431.44 310.04,-431.44 352.21,-431.44 352.21,-431.44 355.17,-431.44 358.12,-434.4 358.12,-437.35 358.12,-437.35 358.12,-443.27 358.12,-443.27 358.12,-446.23 355.17,-449.19 352.21,-449.19"/>
<text xml:space="preserve" text-anchor="start" x="319.12" y="-436.64" font-family="Helvetica,sans-Serif" font-size="9.00">env.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/drizzle.config.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts -->
<g id="edge9" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/drizzle.config.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M257.55,-485.81C264.9,-483.89 272.39,-481.44 279.12,-478.31 292.48,-472.12 305.76,-462.07 315.41,-453.86"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="316.56,-455.65 319.7,-450.13 313.8,-452.49 316.56,-455.65"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts -->
<g id="node12" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts</title>
<g id="a_node12"><a xlink:href="apps/service-scrape/lib-db_service_scrape/src/index.ts" xlink:title="index.ts">
<path fill="#ddfeff" stroke="black" d="M112.71,-415.19C112.71,-415.19 70.54,-415.19 70.54,-415.19 67.58,-415.19 64.62,-412.23 64.62,-409.27 64.62,-409.27 64.62,-403.35 64.62,-403.35 64.62,-400.4 67.58,-397.44 70.54,-397.44 70.54,-397.44 112.71,-397.44 112.71,-397.44 115.67,-397.44 118.62,-400.4 118.62,-403.35 118.62,-403.35 118.62,-409.27 118.62,-409.27 118.62,-412.23 115.67,-415.19 112.71,-415.19"/>
<text xml:space="preserve" text-anchor="start" x="75.88" y="-402.64" font-family="Helvetica,sans-Serif" font-size="9.00">index.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts -->
<g id="node13" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts</title>
<g id="a_node13"><a xlink:href="apps/service-scrape/lib-db_service_scrape/src/kysely.ts" xlink:title="kysely.ts">
<path fill="#ddfeff" stroke="black" d="M238.83,-437.19C238.83,-437.19 196.67,-437.19 196.67,-437.19 193.71,-437.19 190.75,-434.23 190.75,-431.27 190.75,-431.27 190.75,-425.35 190.75,-425.35 190.75,-422.4 193.71,-419.44 196.67,-419.44 196.67,-419.44 238.83,-419.44 238.83,-419.44 241.79,-419.44 244.75,-422.4 244.75,-425.35 244.75,-425.35 244.75,-431.27 244.75,-431.27 244.75,-434.23 241.79,-437.19 238.83,-437.19"/>
<text xml:space="preserve" text-anchor="start" x="200.5" y="-424.64" font-family="Helvetica,sans-Serif" font-size="9.00">kysely.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts -->
<g id="edge10" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M118.95,-410.98C137.87,-414.33 163.52,-418.88 183.81,-422.47"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="183.3,-424.52 189.57,-423.5 184.03,-420.38 183.3,-424.52"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts -->
<g id="node14" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts</title>
<g id="a_node14"><a xlink:href="apps/service-scrape/lib-db_service_scrape/src/schema.ts" xlink:title="schema.ts">
<path fill="#ddfeff" stroke="black" d="M353.83,-419.19C353.83,-419.19 308.42,-419.19 308.42,-419.19 305.46,-419.19 302.5,-416.23 302.5,-413.27 302.5,-413.27 302.5,-407.35 302.5,-407.35 302.5,-404.4 305.46,-401.44 308.42,-401.44 308.42,-401.44 353.83,-401.44 353.83,-401.44 356.79,-401.44 359.75,-404.4 359.75,-407.35 359.75,-407.35 359.75,-413.27 359.75,-413.27 359.75,-416.23 356.79,-419.19 353.83,-419.19"/>
<text xml:space="preserve" text-anchor="start" x="310.5" y="-406.64" font-family="Helvetica,sans-Serif" font-size="9.00">schema.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts -->
<g id="edge11" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M118.95,-406.76C162,-407.48 247.47,-408.92 295.42,-409.73"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="295.27,-411.83 301.31,-409.83 295.34,-407.63 295.27,-411.83"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts -->
<g id="node15" class="node">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts</title>
<g id="a_node15"><a xlink:href="apps/service-scrape/lib-db_service_scrape/src/util.ts" xlink:title="util.ts">
<path fill="#ddfeff" stroke="black" d="M436.21,-412.19C436.21,-412.19 394.04,-412.19 394.04,-412.19 391.08,-412.19 388.12,-409.23 388.12,-406.27 388.12,-406.27 388.12,-400.35 388.12,-400.35 388.12,-397.4 391.08,-394.44 394.04,-394.44 394.04,-394.44 436.21,-394.44 436.21,-394.44 439.17,-394.44 442.12,-397.4 442.12,-400.35 442.12,-400.35 442.12,-406.27 442.12,-406.27 442.12,-409.23 439.17,-412.19 436.21,-412.19"/>
<text xml:space="preserve" text-anchor="start" x="404.62" y="-399.64" font-family="Helvetica,sans-Serif" font-size="9.00">util.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts -->
<g id="edge12" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/index.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M118.8,-402.86C168.76,-396.8 281.12,-385.77 375.12,-395.31 377.06,-395.51 379.04,-395.76 381.03,-396.05"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="380.65,-398.11 386.91,-397.01 381.33,-393.97 380.65,-398.11"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts -->
<g id="edge13" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/env.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M245.14,-431.16C260.82,-432.85 280.82,-435 297.48,-436.8"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="296.83,-438.84 303.02,-437.39 297.28,-434.66 296.83,-438.84"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts -->
<g id="edge14" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/kysely.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts</title>
<path fill="none" stroke="black" d="M245.14,-424.05C260.09,-421.63 278.98,-418.58 295.15,-415.97"/>
<polygon fill="none" stroke="black" points="295.28,-418.07 300.87,-415.04 294.61,-413.92 295.28,-418.07"/>
</g>
<!-- apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts -->
<g id="edge15" class="edge">
<title>apps/service&#45;scrape/lib&#45;db_service_scrape/src/schema.ts&#45;&gt;apps/service&#45;scrape/lib&#45;db_service_scrape/src/util.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M359.89,-407.94C366.65,-407.37 373.94,-406.74 380.93,-406.15"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="381.07,-408.24 386.87,-405.64 380.72,-404.06 381.07,-408.24"/>
</g>
<!-- apps/service&#45;scrape/script/compress.ts -->
<g id="node16" class="node">
<title>apps/service&#45;scrape/script/compress.ts</title>
<g id="a_node16"><a xlink:href="apps/service-scrape/script/compress.ts" xlink:title="compress.ts">
<path fill="#ddfeff" stroke="black" d="M118.08,-127.19C118.08,-127.19 65.17,-127.19 65.17,-127.19 62.21,-127.19 59.25,-124.23 59.25,-121.27 59.25,-121.27 59.25,-115.35 59.25,-115.35 59.25,-112.4 62.21,-109.44 65.17,-109.44 65.17,-109.44 118.08,-109.44 118.08,-109.44 121.04,-109.44 124,-112.4 124,-115.35 124,-115.35 124,-121.27 124,-121.27 124,-124.23 121.04,-127.19 118.08,-127.19"/>
<text xml:space="preserve" text-anchor="start" x="67.25" y="-114.64" font-family="Helvetica,sans-Serif" font-size="9.00">compress.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/script/util.ts -->
<g id="node17" class="node">
<title>apps/service&#45;scrape/script/util.ts</title>
<g id="a_node17"><a xlink:href="apps/service-scrape/script/util.ts" xlink:title="util.ts">
<path fill="#ddfeff" stroke="black" d="M238.83,-127.19C238.83,-127.19 196.67,-127.19 196.67,-127.19 193.71,-127.19 190.75,-124.23 190.75,-121.27 190.75,-121.27 190.75,-115.35 190.75,-115.35 190.75,-112.4 193.71,-109.44 196.67,-109.44 196.67,-109.44 238.83,-109.44 238.83,-109.44 241.79,-109.44 244.75,-112.4 244.75,-115.35 244.75,-115.35 244.75,-121.27 244.75,-121.27 244.75,-124.23 241.79,-127.19 238.83,-127.19"/>
<text xml:space="preserve" text-anchor="start" x="207.25" y="-114.64" font-family="Helvetica,sans-Serif" font-size="9.00">util.ts</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/script/compress.ts&#45;&gt;apps/service&#45;scrape/script/util.ts -->
<g id="edge16" class="edge">
<title>apps/service&#45;scrape/script/compress.ts&#45;&gt;apps/service&#45;scrape/script/util.ts</title>
<path fill="none" stroke="black" stroke-width="0.6" d="M124.27,-118.31C142.56,-118.31 165.54,-118.31 184.02,-118.31"/>
<polygon fill="black" stroke="black" stroke-width="0.6" points="183.7,-120.41 189.7,-118.31 183.7,-116.21 183.7,-120.41"/>
</g>
<!-- fs -->
<g id="node18" class="node">
<title>fs</title>
<g id="a_node18"><a xlink:href="https://nodejs.org/api/fs.html" xlink:title="fs">
<path fill="#ffffcc" stroke="grey" d="M352.21,-33.19C352.21,-33.19 310.04,-33.19 310.04,-33.19 307.08,-33.19 304.12,-30.23 304.12,-27.27 304.12,-27.27 304.12,-21.35 304.12,-21.35 304.12,-18.4 307.08,-15.44 310.04,-15.44 310.04,-15.44 352.21,-15.44 352.21,-15.44 355.17,-15.44 358.12,-18.4 358.12,-21.35 358.12,-21.35 358.12,-27.27 358.12,-27.27 358.12,-30.23 355.17,-33.19 352.21,-33.19"/>
<text xml:space="preserve" text-anchor="start" x="327.75" y="-20.64" font-family="Helvetica,sans-Serif" font-size="9.00" fill="grey">fs</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/script/compress.ts&#45;&gt;fs -->
<g id="edge17" class="edge">
<title>apps/service&#45;scrape/script/compress.ts&#45;&gt;fs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M116.84,-108.95C128.26,-103.27 140.97,-94.86 148.38,-83.31 155.76,-71.8 146.1,-31.33 156.38,-22.31 195.44,11.96 260.61,-0.8 299.06,-12.81"/>
<polygon fill="black" stroke="black" points="298.13,-14.72 304.48,-14.57 299.42,-10.72 298.13,-14.72"/>
</g>
<!-- apps/service&#45;scrape/script/util.ts&#45;&gt;fs -->
<g id="edge18" class="edge">
<title>apps/service&#45;scrape/script/util.ts&#45;&gt;fs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M241.16,-109.08C253.98,-102.74 269.4,-93.14 279.12,-80.31 286.68,-70.34 279.72,-63.41 287.12,-53.31 291.68,-47.1 297.99,-41.81 304.37,-37.51"/>
<polygon fill="black" stroke="black" points="305.46,-39.3 309.43,-34.34 303.23,-35.74 305.46,-39.3"/>
</g>
<!-- zlib -->
<g id="node19" class="node">
<title>zlib</title>
<g id="a_node19"><a xlink:href="https://nodejs.org/api/zlib.html" xlink:title="zlib">
<path fill="#ffffcc" stroke="grey" d="M352.21,-77.19C352.21,-77.19 310.04,-77.19 310.04,-77.19 307.08,-77.19 304.12,-74.23 304.12,-71.27 304.12,-71.27 304.12,-65.35 304.12,-65.35 304.12,-62.4 307.08,-59.44 310.04,-59.44 310.04,-59.44 352.21,-59.44 352.21,-59.44 355.17,-59.44 358.12,-62.4 358.12,-65.35 358.12,-65.35 358.12,-71.27 358.12,-71.27 358.12,-74.23 355.17,-77.19 352.21,-77.19"/>
<text xml:space="preserve" text-anchor="start" x="324" y="-64.64" font-family="Helvetica,sans-Serif" font-size="9.00" fill="grey">zlib</text>
</a>
</g>
</g>
<!-- apps/service&#45;scrape/script/util.ts&#45;&gt;zlib -->
<g id="edge19" class="edge">
<title>apps/service&#45;scrape/script/util.ts&#45;&gt;zlib</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M239.44,-109.03C257.33,-100.99 283.34,-89.32 302.91,-80.53"/>
<polygon fill="black" stroke="black" points="303.55,-82.54 308.17,-78.17 301.83,-78.71 303.55,-82.54"/>
</g>
</g>
</svg>
    <script>
      var gMode = new Mode();

var title2ElementMap = (function makeElementMap() {
  /** @type {NodeListOf<SVGGElement>} */
  var nodes = document.querySelectorAll(".node");
  /** @type {NodeListOf<SVGGElement>} */
  var edges = document.querySelectorAll(".edge");
  return new Title2ElementMap(edges, nodes);
})();

function getHoverHandler(pTitle2ElementMap) {
  /** @type {string} */
  var currentHighlightedTitle = "";

  /** @param {MouseEvent} pMouseEvent */
  return function hoverHighlightHandler(pMouseEvent) {
    var closestNodeOrEdge = pMouseEvent.target.closest(".edge, .node");
    var closestTitleText = getTitleText(closestNodeOrEdge);

    if (
      currentHighlightedTitle !== closestTitleText &&
      gMode.get() === gMode.HOVER
    ) {
      resetNodesAndEdges();
      addHighlight(closestNodeOrEdge);
      pTitle2ElementMap.get(closestTitleText).forEach(addHighlight);
      currentHighlightedTitle = closestTitleText;
    }
  };
}

function getSelectHandler(pTitle2ElementMap) {
  /** @type {string} */
  var currentHighlightedTitle = "";

  /** @param {MouseEvent} pMouseEvent */
  return function selectHighlightHandler(pMouseEvent) {
    pMouseEvent.preventDefault();

    var closestNodeOrEdge = pMouseEvent.target.closest(".edge, .node");
    var closestTitleText = getTitleText(closestNodeOrEdge);

    if (closestNodeOrEdge) {
      gMode.setToSelect();
    } else {
      gMode.setToHover();
    }
    if (currentHighlightedTitle !== closestTitleText) {
      resetNodesAndEdges();
      addHighlight(closestNodeOrEdge);
      pTitle2ElementMap.get(closestTitleText).forEach(addHighlight);
      currentHighlightedTitle = closestTitleText;
    }
  };
}
function Mode() {
  var HOVER = 1;
  var SELECT = 2;

  function setToHover() {
    this._mode = HOVER;
  }
  function setToSelect() {
    this._mode = SELECT;
  }

  /**
   * @returns {number}
   */
  function get() {
    return this._mode || HOVER;
  }

  return {
    HOVER: HOVER,
    SELECT: SELECT,
    setToHover: setToHover,
    setToSelect: setToSelect,
    get: get,
  };
}

/**
 *
 * @param {SVGGelement[]} pEdges
 * @param {SVGGElement[]} pNodes
 * @return {{get: (pTitleText:string) => SVGGElement[]}}
 */
function Title2ElementMap(pEdges, pNodes) {
  /* {{[key: string]: SVGGElement[]}} */
  var elementMap = buildMap(pEdges, pNodes);

  /**
   * @param {NodeListOf<SVGGElement>} pEdges
   * @param {NodeListOf<SVGGElement>} pNodes
   * @return {{[key: string]: SVGGElement[]}}
   */
  function buildMap(pEdges, pNodes) {
    var title2NodeMap = buildTitle2NodeMap(pNodes);

    return nodeListToArray(pEdges).reduce(addEdgeToMap(title2NodeMap), {});
  }
  /**
   * @param {NodeListOf<SVGGElement>} pNodes
   * @return {{[key: string]: SVGGElement}}
   */
  function buildTitle2NodeMap(pNodes) {
    return nodeListToArray(pNodes).reduce(addNodeToMap, {});
  }

  function addNodeToMap(pMap, pNode) {
    var titleText = getTitleText(pNode);

    if (titleText) {
      pMap[titleText] = pNode;
    }
    return pMap;
  }

  function addEdgeToMap(pNodeMap) {
    return function (pEdgeMap, pEdge) {
      /** @type {string} */
      var titleText = getTitleText(pEdge);

      if (titleText) {
        var edge = pryEdgeFromTitle(titleText);

        pEdgeMap[titleText] = [pNodeMap[edge.from], pNodeMap[edge.to]];
        (pEdgeMap[edge.from] || (pEdgeMap[edge.from] = [])).push(pEdge);
        (pEdgeMap[edge.to] || (pEdgeMap[edge.to] = [])).push(pEdge);
      }
      return pEdgeMap;
    };
  }

  /**
   *
   * @param {string} pString
   * @return {{from?: string; to?:string;}}
   */
  function pryEdgeFromTitle(pString) {
    var nodeNames = pString.split(/\s*->\s*/);

    return {
      from: nodeNames.shift(),
      to: nodeNames.shift(),
    };
  }
  /**
   *
   * @param {string} pTitleText
   * @return {SVGGElement[]}
   */
  function get(pTitleText) {
    return (pTitleText && elementMap[pTitleText]) || [];
  }
  return {
    get: get,
  };
}

/**
 * @param {SVGGElement} pGElement
 * @return {string?}
 */
function getTitleText(pGElement) {
  /** @type {SVGTitleElement} */
  var title = pGElement && pGElement.querySelector("title");
  /** @type {string} */
  var titleText = title && title.textContent;

  if (titleText) {
    titleText = titleText.trim();
  }
  return titleText;
}

/**
 * @param {NodeListOf<Element>} pNodeList
 * @return {Element[]}
 */
function nodeListToArray(pNodeList) {
  var lReturnValue = [];

  pNodeList.forEach(function (pElement) {
    lReturnValue.push(pElement);
  });

  return lReturnValue;
}

function resetNodesAndEdges() {
  nodeListToArray(document.querySelectorAll(".current")).forEach(
    removeHighlight,
  );
}

/**
 * @param {SVGGElement} pGElement
 */
function removeHighlight(pGElement) {
  if (pGElement && pGElement.classList) {
    pGElement.classList.remove("current");
  }
}

/**
 * @param {SVGGElement} pGroup
 */
function addHighlight(pGroup) {
  if (pGroup && pGroup.classList) {
    pGroup.classList.add("current");
  }
}

var gHints = {
  HIDDEN: 1,
  SHOWN: 2,
  state: 1, // === HIDDEN
  show: function () {
    document.getElementById("hints").removeAttribute("style");
    gHints.state = gHints.SHOWN;
  },
  hide: function () {
    document.getElementById("hints").style = "display:none";
    gHints.state = gHints.HIDDEN;
  },
  toggle: function () {
    if ((gHints.state || gHints.HIDDEN) === gHints.HIDDEN) {
      gHints.show();
    } else {
      gHints.hide();
    }
  },
};

/** @param {KeyboardEvent} pKeyboardEvent */
function keyboardEventHandler(pKeyboardEvent) {
  if (pKeyboardEvent.key === "Escape") {
    resetNodesAndEdges();
    gMode.setToHover();
    gHints.hide();
  }
  if (pKeyboardEvent.key === "F1") {
    pKeyboardEvent.preventDefault();
    gHints.toggle();
  }
}

document.addEventListener("contextmenu", getSelectHandler(title2ElementMap));
document.addEventListener("mouseover", getHoverHandler(title2ElementMap));
document.addEventListener("keydown", keyboardEventHandler);
document.getElementById("close-hints").addEventListener("click", gHints.hide);
document.getElementById("button_help").addEventListener("click", gHints.toggle);
document.querySelector("svg").insertAdjacentHTML(
  "afterbegin",
  `<linearGradient id="edgeGradient">
      <stop offset="0%" stop-color="fuchsia"/>
      <stop offset="100%" stop-color="purple"/>
   </linearGradient>
  `,
);

// Add a small increment to the last value of the path to make gradients on
// horizontal paths work. Without them all browsers I tested with (firefox,
// chrome) do not render the gradient, but instead make the line transparent
// (or the color of the background, I haven't looked into it that deeply,
// but for the hack it doesn't matter which).
function skewLineABit(lDrawingInstructions) {
  var lLastValue = lDrawingInstructions.match(/(\d+\.?\d*)$/)[0];
  // Smaller values than .001 _should_ work as well, but don't in all
  // cases. Even this value is so small that it is not visible to the
  // human eye (tested with the two I have at my disposal).
  var lIncrement = 0.001;
  var lNewLastValue = parseFloat(lLastValue) + lIncrement;

  return lDrawingInstructions.replace(lLastValue, lNewLastValue);
}

nodeListToArray(document.querySelectorAll("path"))
  .filter(function (pElement) {
    return pElement.parentElement.classList.contains("edge");
  })
  .forEach(function (pElement) {
    pElement.attributes.d.value = skewLineABit(pElement.attributes.d.value);
  });

    </script>
  </body>
</html>
